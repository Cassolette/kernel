KERNEL_SRC ?= /lib/modules/$(shell uname -r)/build

KBUILD_OPTIONS := WLAN_ROOT=$(PWD)
KBUILD_OPTIONS += MODNAME?=wlan

#By default build for CLD
WLAN_SELECT := CONFIG_QCA_CLD_WLAN=m

# WUSB6100M TEMPORARY CFG
KBUILD_OPTIONS += CONFIG_ROME_IF=usb
KBUILD_OPTIONS += CONFIG_MODNAME=wlan-usb
#KBUILD_OPTIONS += CONFIG_QCA_CLD_WLAN_PROFILE=qca6174 # future releases

KBUILD_OPTIONS += CONFIG_QCA_WIFI_ISOC=0
KBUILD_OPTIONS += CONFIG_QCA_WIFI_2_0=1
KBUILD_OPTIONS += $(WLAN_SELECT)
KBUILD_OPTIONS += $(KBUILD_EXTRA) # Extra config if any

all:
	$(MAKE) -C $(KERNEL_SRC) M=$(shell pwd) modules $(KBUILD_OPTIONS)

modules_install:
	$(MAKE) INSTALL_MOD_STRIP=1 -C $(KERNEL_SRC) M=$(shell pwd) modules_install

clean:
	$(MAKE) -C $(KERNEL_SRC) M=$(PWD) clean
